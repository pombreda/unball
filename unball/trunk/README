Unball 0.2.10
by deitarion (Stephan Sokolow)
Version 0.2.10

Inspired by maitre's unball (http://kdelook.org/content/show.php?content=12561)
(It would be based on it, but there was none of the old code left by the time I was done the first release)

Version 1.0.0 of this script will be released when I am satisfied that the interface behaviour has stabilized and
	that the list of supported archive formats and planned features is small is big enough.
The changelog may now be found in the ChangeLog file.

==== Installation: ====

To install unball, just copy it to /usr/local/bin
All uses require unball to be in the search path.

==== Usage: ====

Just run `unball someArchive.zip` and let it do it's thing.
For details, run `unball --help`.

Supplemental features:
- To run the unit tests, run ./runTests.py from inside this directory.
- To add the KDE service menu, copy unball.desktop to ~/.kde/share/apps/konqueror/servicemenus/

==== Programmer's TODO list: ====

Known Bugs:
- unball can create empty directories in some situations
- unace freezes when unball is a Konqueror Action. This seems to mainly manifest itself as an inability to 
  extract .ACE and .EXE files via the .desktop file for Konqueror and I suspect it's because unace
  doesn't check whether it has a valid stdin, stdout, and stderr.
- In the case of one or more files having corrupted contents, unball refuses to extract ACE archives.
  I suspect this is a problem with a lot more formats. I'll have to write some unit tests and fix the
  problem. (The problem is that unball just aborts if the backend tool returns a nonzero exit code.)
- arj isn't being passed an "always answer yes" flag which is vital for extracting split ARJ files.
- arj won't be able to extract split ARJ files when the contents cross archive boundaries. A solution will
  require some of the same changes that fixing problems related to split RAR files requires.
- If the archive name or the name of the extracted program contains spaces, then I suspect the script
  will always create a containing folder. I have not yet confirmed this.
- Cannot extract multi-volume archives generated by GNU tar's -M option. (Note to self: see 
  http://www.gnu.org/software/tar/manual/html_node/Using-Multiple-Tapes.html for reference)

Notes:
- MacOS X .pkg packages are actually just directories and .mpkg files are data files which aren't archives.

System Integration:
- Create and bundle a nautilus script (http://g-scripts.sourceforge.net/)
- The Konqueror script (completed, but suffers from an ACE-related bug) should give some kind of warning on failure.
- moveToZip.desktop and moveToZip.sh should be shared with the world since they work so well with unball as a 
  temporary FrAT (pre-final name) alternative.
- Whip up a quick install.sh which installs unball to /usr/local/bin and adds the Konqueror action if Konqueror
  is installed. (using $X/share/apps/konqueror/servicemenus where $X is an entry in $KDEDIRS)

Formats and Tools:
- Add support for zip files using bzip2 compression. (p7zip can extract them)
- Add support for using nomarch as an alternative to arc
- Unball only supports Java .war files. (renamed zips) Konqueror .war files are renamed .tgz files.
- Figure out what PC-BSD Installers (.pbi) MacOS X .dist files, .slp, and Ruby gems (.gem)  are, internally.
- Get around to adding lzma, qda, atr, sitx (Stuffit X)
- Look for a way to add support for zip archives compressed using ppmd. (Created by WinZip 10)
- Figure out whether the following programs generate something unball doesn't already unpack: freeze, pax, ppmd, upm
- Consider adding a switch which enables use of UPX decompression when applicable. (UPX is an executable packer)
- Figure out what .xef files are. (WinACE offers to handle them)
- Figure out exactly what format *.slp files use and call the decompressor directly rather than converting them to .tgz with alien.
- Figure out how to make a .bhx file (BinHex ASCII, according to filext.com) for the tests.
- Add more support for identifying disk image formats that cannot be unpacked by unball. (eg. ISO, DMG, BIN, CCD, etc.)
- Add proper split archive support (RAR, ZIP, ACE, ARJ, and what else?)
- Add unshield to the list of *.exe checks if it's capable of unpacking single-file installshield packs.

Documentation:
- Write a simple tutorial explaining how to use Konqueror, unball, and moveToZip to efficiently do a
	manual recursive conversion similar to what FrAT (pre-final name) does.

Unit Tests:
- Ensure that the extraction tool gets to pick the name when the archive only contains one file or folder.
- Borrow a windows computer and create test files for self-extracting ARJ, LHA, and ZOO.
- Make unball use stderr for error messages.
- Add --silent to unball and remove the /dev/null redirect in the unit tests
- Add unit tests for split archives (especially split ACE, split RAR using numbered extension (.r## and .###),
	split RAR using numbered suffixes (.part#.rar), and split ARJ)
- Add a check and a unit test for split ACE files where the first file (*.ACE) is uppercase and the 
	following files (*.c??) are lowercase. It freezes up unace and therefor freezes up unball.
- Add tests for password-protected archives. (Zip, RAR, and ACE for starters)
- Implement a method of testing each program for formats which can be extracted using multiple backend tools.
- Don't forget to include unit tests in FrAT (pre-final name) to ensure that it recognizes and handles unball errors safely.
- Ensure that unball passes "Missing Extractor" errors out to the calling program as exit codes.
- Make test archives for:
  - Specialized variants of currently tested formats: .egg, .ipk
  - Un-tested self-extractors: arj, lha, sea
  - Stuff which may be difficult to create: .tar.z, .tar.Z, .sea.bin, .sit.bin, .dms, .adf, .adz, .alz, .cab (InstallShield), .paq6, .sfark, .slp
  - Stuff which has been tested using non-redistributable (or overly large) archives: .deb, .lzx, .rpm, .sea.hqx, .tar.Z
  - Stuff which cannot currently be supported: .sitx, .bh, .cpt, .dar, .dgc, .gca, .msi, .partimg, .rk, .sfpack, .shar, .sqx, .zz
- Test unball's behaviour when handed multiple arguments in the same run.

For Version 0.3.0 (next after 0.2.10):
- Switch to using header-based detection as default and extension checking as a fallback.
- Make detection by header default so that Zip files with .rar extensions will extract. (using header detection)

Miscellaneous:
- Add optional use of the Gentoo Portage sandbox to ensure nothing gets changed outside of the target dir.
- Decide how to best warn people away from formats like RAR due to their highly proprietary nature.
- Add support for recursively unpacking nested archives
- IDEA: Use a while loop and the -k option for the file command to allow properly robust extraction of files with ambiguous headers.
- Look into the option of doing the "move from temp" and "unpack next archive" stages simultaneously to speed
  things on systems where /tmp isn't on the same partition as $TARGET
